TODO work on map reduce function